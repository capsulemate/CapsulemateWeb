<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

      <style>
          #header {  
              margin-bottom: 20px;
               background-color: #e47e51;
              text-align: center;
              padding: 24px 0;
              position: relative; }
              #header a {
                width: 100%;
                text-decoration: none;
                color: #222222;
                display: inline-block; }
              #header img {
                max-height: 150px;
                margin: 0 auto;
                display: block; }
              #header h1 {
                font-family: 'Signika', sans-serif;
                font-weight: 600; }
            #header h2 {
                color: white;
                font-family: 'Signika', sans-serif;
                font-weight: 300; }
              #header:after {
                display: block;
                content: '';
                width: 5rem;
                height: 1px;
                margin: 23px auto;
                background-color: #d5d5d5; }
      </style>
    <title>Hello, world!</title>
  </head>
  <body>
<header id="header">
	<a href="index.html">
	  <img src='img/logo.png' alt='logo'>
	</a>
</header>
      <div class="container">
          
          <div id="accordion">
  <div class="card">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
          <h4 style="color:black">Quadrant 0</h4>
        </button>
      </h5>
    </div>

    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">
          <!-- Quadrant 0 form start -->
        <form>
  <div class="form-group">
    <label for="med_name0"><h5>Medication Name</h5></label>
    <input type="text" class="form-control" id="med_name0" placeholder="">
  </div>
  <div class="form-group">
    <label for="pill_size0"><h5>Pill Size</h5></label>
    <select class="form-control" id="pill_size0">
      <option disabled selected value> -- select a size -- </option>
      <option>00</option>
      <option>0</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
<div class="form-group">
    <label for="pill_num0"><h5>Total Number of Pills</h5></label>
    <input type="number" class="form-control" id="pill_num0" placeholder="">
  </div>
<div class="form-group">
    <label for="pills_per_dose0"><h5>Number of Pills per Dose</h5></label>
    <input type="number" class="form-control" id="pills_per_dose0" placeholder="">
  </div>
<div class="form-group">
    <label for="dispense_times0"><h5>Dispense Times</h5>(In format HH:MM separated by commas, E.g., 09:30,18:45)</label>
    <input type="text" class="form-control" id="dispense_times0" placeholder="">
  </div>
</form>
          <!-- Quadrant 0 form end -->
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          <h4 style="color:black">Quadrant 1</h4>
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
          <!-- Quadrant 1 form start -->
        <form>
  <div class="form-group">
    <label for="med_name1"><h5>Medication Name</h5></label>
    <input type="text" class="form-control" id="med_name1" placeholder="">
  </div>
  <div class="form-group">
    <label for="pill_size1"><h5>Pill Size</h5></label>
    <select class="form-control" id="pill_size1">
      <option disabled selected value> -- select a size -- </option>
      <option>00</option>
      <option>0</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
<div class="form-group">
    <label for="pill_num1"><h5>Total Number of Pills</h5></label>
    <input type="number" class="form-control" id="pill_num1" placeholder="">
  </div>
<div class="form-group">
    <label for="pills_per_dose1"><h5>Number of Pills per Dose</h5></label>
    <input type="number" class="form-control" id="pills_per_dose1" placeholder="">
  </div>
<div class="form-group">
    <label for="dispense_times1"><h5>Dispense Times</h5>(In format HH:MM separated by commas, E.g., 09:30,18:45)</label>
    <input type="text" class="form-control" id="dispense_times1" placeholder="">
  </div>
</form>
          <!-- Quadrant 1 form end -->
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          <h4 style="color:black">Quadrant 2</h4>
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">
          <!-- Quadrant 2 form start -->
        <form>
  <div class="form-group">
    <label for="med_name2"><h5>Medication Name</h5></label>
    <input type="text" class="form-control" id="med_name2" placeholder="">
  </div>
  <div class="form-group">
    <label for="pill_size2"><h5>Pill Size</h5></label>
    <select class="form-control" id="pill_size2">
      <option disabled selected value> -- select a size -- </option>
      <option>00</option>
      <option>0</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
<div class="form-group">
    <label for="pill_num2"><h5>Total Number of Pills</h5></label>
    <input type="number" class="form-control" id="pill_num2" placeholder="">
  </div>
<div class="form-group">
    <label for="pills_per_dose2"><h5>Number of Pills per Dose</h5></label>
    <input type="number" class="form-control" id="pills_per_dose2" placeholder="">
  </div>
<div class="form-group">
    <label for="dispense_times2"><h5>Dispense Times</h5>(In format HH:MM separated by commas, E.g., 09:30,18:45)</label>
    <input type="text" class="form-control" id="dispense_times2" placeholder="">
  </div>
</form>
          <!-- Quadrant 2 form end -->
      </div>
    </div>
  </div>
<div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          <h4 style="color:black">Quadrant 3</h4>
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">
          <!-- Quadrant 3 form start -->
        <form>
  <div class="form-group">
    <label for="med_name3"><h5>Medication Name</h5></label>
    <input type="text" class="form-control" id="med_name3" placeholder="">
  </div>
  <div class="form-group">
    <label for="pill_size3"><h5>Pill Size</h5></label>
    <select class="form-control" id="pill_size3">
      <option disabled selected value> -- select a size -- </option>
      <option>00</option>
      <option>0</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
    </select>
  </div>
<div class="form-group">
    <label for="pill_num3"><h5>Total Number of Pills</h5></label>
    <input type="number" class="form-control" id="pill_num3" placeholder="">
  </div>
<div class="form-group">
    <label for="pills_per_dose3"><h5>Number of Pills per Dose</h5></label>
    <input type="number" class="form-control" id="pills_per_dose3" placeholder="">
  </div>
<div class="form-group">
    <label for="dispense_times3"><h5>Dispense Times</h5>(In format HH:MM separated by commas, E.g., 09:30,18:45)</label>
    <input type="text" class="form-control" id="dispense_times3" placeholder="">
  </div>
</form>
          <!-- Quadrant 0 form end -->
      </div>
    </div>
  </div>
</div>
<div class="row" style="height: 50px;">  
</div> 
<div class="row" style="height: 50px;">    
 <button type="button" class="btn btn-secondary" onclick="create_json()">Submit</button>  
</div>
<div class="row" style="height: 50px;">  
</div> 
 <div class="row" style="height: 50px;"> 
     <p id="submit-confirmation"></p>
</div>
          <div class="row" style="height: 50px;">  
</div> 
<div class="row"> 
     <a class="btn btn-secondary" id="confirm_button" style="display:none">Confirm submission</a>
</div>
          
          

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
          
          
<script>
    
    var PILL_SIZE_MAPPING = {
        "00": 1,
        "0": 2,
        "1": 3,
        "2": 3,
        "3": 4,
        "4": 4
    }
    
    function create_json() {
        var json_output = {};
        var i;
        for (i=0; i<4; i++){
            med_name = document.getElementById("med_name"+ i).value;
            pill_size = PILL_SIZE_MAPPING[document.getElementById("pill_size"+ i).value];
            pill_num = parseInt(document.getElementById("pill_num"+ i).value);
            pills_per_dose = parseInt(document.getElementById("pills_per_dose"+ i).value);
            dispense_times = document.getElementById("dispense_times"+ i).value;
            if (med_name=="" || isNaN(pill_size) || isNaN(pill_num) || isNaN(pills_per_dose) || dispense_times==""){
                // form not filled out or incomplete
                console.log("Quadrant " + i + ": NOT INCLUDED")
                continue;
            }
            dispense_times = dispense_times.split(",");
            
            quadrant_json = {};
            quadrant_json["StorageContainer"] = i;
            quadrant_json["Name"] = med_name;
            quadrant_json["Size"] = pill_size;
            quadrant_json["NumPills"] = pill_num;
            quadrant_json["PillsPerDose"] = pills_per_dose;
            quadrant_json["DispenseTimes"] = dispense_times;
            
            json_output[med_name] = quadrant_json;
            console.log("Quadrant " + i + ": INCLUDED")
            console.log(quadrant_json)
            document.getElementById("submit-confirmation").innerHTML = document.getElementById("submit-confirmation").innerHTML + "Quadrant " + i + " has been added <br>";
        }
        
        // host/save json
        var blob = new Blob( [JSON.stringify(json_output)] , {
                type: 'application/octet-stream'
        });
        url = URL.createObjectURL( blob );
        var link = document.getElementById("confirm_button");
        link.style.display = "block";
        link.setAttribute( 'href', url );
        link.setAttribute( 'download', 'template.json' );
    }
</script>      
          
          
  </body>
</html>